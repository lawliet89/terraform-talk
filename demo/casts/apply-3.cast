{"version": 2, "width": 140, "height": 31, "timestamp": 1535696519, "env": {"SHELL": "/bin/bash", "TERM": "xterm-256color"}}
[0.401489, "o", "yongwen@yongwen-thinkpad-470s:~/work/open/terraform-talk/demo (\u001b[32mmaster\u001b[0m \u001b[31m*\u001b[0m>)$ "]
[0.712318, "o", "AWS_PROFILE=ace terraform apply --var-file vars.tfvars"]
[1.539277, "o", "\r\n"]
[5.839421, "o", "\u001b[0m\u001b[1mdata.template_file.server_user_data: Refreshing state...\u001b[0m\r\n"]
[7.669538, "o", "\u001b[0m\u001b[1maws_lb_target_group.server: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...terraform-demo-server/3075d3ca840f4e90)\u001b[0m\r\n"]
[7.670855, "o", "\u001b[0m\u001b[1maws_security_group.server: Refreshing state... (ID: sg-06ca0ba9b5045a065)\u001b[0m\r\n"]
[7.672776, "o", "\u001b[0m\u001b[1maws_security_group.lb: Refreshing state... (ID: sg-00ea24fe65e8ba90e)\u001b[0m\r\n"]
[7.674382, "o", "\u001b[0m\u001b[1maws_security_group.client: Refreshing state... (ID: sg-02d6f5605d7bb7e4a)\u001b[0m\r\n"]
[7.676199, "o", "\u001b[0m\u001b[1maws_lb_target_group.client: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...terraform-demo-client/f5f7ec5f6941581c)\u001b[0m\r\n"]
[7.677559, "o", "\u001b[0m\u001b[1maws_lb_target_group.sink: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...p/terraform-demo-sink/ff00814c63c5660c)\u001b[0m\r\n"]
[7.680363, "o", "\u001b[0m\u001b[1mdata.aws_route53_zone.domain: Refreshing state...\u001b[0m\r\n"]
[7.682414, "o", "\u001b[0m\u001b[1mdata.aws_ami.ubuntu: Refreshing state...\u001b[0m"]
[7.682848, "o", "\r\n"]
[7.761515, "o", "\u001b[0m\u001b[1maws_security_group_rule.lb_https_ingress: Refreshing state... (ID: sgrule-1554186798)\u001b[0m"]
[7.764937, "o", "\r\n"]
[7.769099, "o", "\u001b[0m\u001b[1maws_security_group_rule.lb_http_ingress: Refreshing state... (ID: sgrule-941744604)\u001b[0m"]
[7.770746, "o", "\r\n"]
[7.771274, "o", "\u001b[0m\u001b[1maws_lb.lb: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...er/app/terraform-demo/04ae4963ce8b540f)\u001b[0m"]
[7.774838, "o", "\r\n"]
[7.775964, "o", "\u001b[0m\u001b[1maws_security_group_rule.lb_client_egress: Refreshing state... (ID: sgrule-68608736)\u001b[0m\r\n"]
[7.794996, "o", "\u001b[0m\u001b[1maws_security_group_rule.client_lb_inbound: Refreshing state... (ID: sgrule-2084411941)\u001b[0m\r\n"]
[7.839891, "o", "\u001b[0m\u001b[1maws_security_group_rule.client_ssh_inbound: Refreshing state... (ID: sgrule-406649271)\u001b[0m\r\n"]
[7.869267, "o", "\u001b[0m\u001b[1maws_security_group_rule.client_egress: Refreshing state... (ID: sgrule-1676281515)\u001b[0m\r\n"]
[7.874527, "o", "\u001b[0m\u001b[1maws_security_group_rule.server_egress: Refreshing state... (ID: sgrule-3886950745)\u001b[0m"]
[7.875193, "o", "\r\n"]
[7.909363, "o", "\u001b[0m\u001b[1maws_security_group_rule.server_lb_inbound: Refreshing state... (ID: sgrule-2742169836)\u001b[0m"]
[7.909658, "o", "\r\n"]
[7.910815, "o", "\u001b[0m\u001b[1maws_security_group_rule.server_ssh_inbound: Refreshing state... (ID: sgrule-3037685237)\u001b[0m\r\n"]
[7.943601, "o", "\u001b[0m\u001b[1maws_security_group_rule.lb_server_egress: Refreshing state... (ID: sgrule-3102978866)\u001b[0m\r\n"]
[7.946579, "o", "\u001b[0m\u001b[1maws_launch_configuration.server: Refreshing state... (ID: terraform-demo-server20180831055342060600000002)\u001b[0m\r\n"]
[8.046946, "o", "\u001b[0m\u001b[1maws_lb_listener.front_end: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...demo/04ae4963ce8b540f/7fb0c481594d516a)\u001b[0m"]
[8.048048, "o", "\r\n"]
[8.048344, "o", "\u001b[0m\u001b[1maws_lb_listener.https: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...demo/04ae4963ce8b540f/e1124ab23b65a20a)\u001b[0m\r\n"]
[8.112818, "o", "\u001b[0m\u001b[1maws_lb_listener_certificate.server: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...e/992aea66-8188-418a-b38e-88ec2df2526e)\u001b[0m"]
[8.113547, "o", "\r\n"]
[8.172735, "o", "\u001b[0m\u001b[1maws_autoscaling_group.server: Refreshing state... (ID: terraform-demo-server)\u001b[0m\r\n"]
[8.317921, "o", "\u001b[0m\u001b[1maws_autoscaling_attachment.server: Refreshing state... (ID: terraform-demo-server-20180831053405780000000004)\u001b[0m\r\n"]
[9.862621, "o", "\u001b[0m\u001b[1maws_lb_listener_rule.server: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...540f/e1124ab23b65a20a/2d14cc4d97c79fb4)\u001b[0m\r\n"]
[9.865111, "o", "\u001b[0m\u001b[1maws_lb_listener_rule.client: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...540f/e1124ab23b65a20a/148e0cba47802291)\u001b[0m"]
[9.865843, "o", "\r\n"]
[9.866451, "o", "\u001b[0m\u001b[1maws_launch_configuration.client: Refreshing state... (ID: terraform-demo-client20180831061205010400000001)\u001b[0m\r\n"]
[10.075402, "o", "\u001b[0m\u001b[1maws_autoscaling_group.client: Refreshing state... (ID: terraform-demo-client)\u001b[0m\r\n"]
[10.287523, "o", "\u001b[0m\u001b[1maws_autoscaling_attachment.client: Refreshing state... (ID: terraform-demo-client-20180831053725363100000006)\u001b[0m\r\n"]
[12.346086, "o", "\r\n"]
[12.346146, "o", "An execution plan has been generated and is shown below.\r\n"]
[12.346171, "o", "Resource actions are indicated with the following symbols:\r\n"]
[12.346196, "o", "  \u001b[32m+\u001b[0m create\r\n"]
[12.346215, "o", "  \u001b[33m~\u001b[0m update in-place\r\n"]
[12.346528, "o", "  \u001b[31m-\u001b[0m destroy\r\n\u001b[31m-\u001b[0m/\u001b[32m+\u001b[0m destroy and then create replacement\r\n \u001b[36m<=\u001b[0m read (data resources)\r\n\u001b[0m\r\nTerraform will perform the following actions:\r\n\r\n\u001b[36m \u001b[36m<=\u001b[0m \u001b[36mdata.template_file.client_user_data\r\n"]
[12.346587, "o", "\u001b[0m      id:                                        <computed>\r\n"]
[12.346613, "o", "      rendered:                                  <computed>\r\n"]
[12.347526, "o", "      template:                                  \"#!/usr/bin/env bash\\nset -euo pipefail\\n\\n# Send the log output from this script to user-data.log, syslog, and the console\\n# From: https://alestic.com/2010/12/ec2-user-data-output/\\nexec > >(tee /var/log/user-data.log|logger -t user-data -s 2>/dev/console) 2>&1\\n\\n# Install dependencies\\n\\napt-get update\\napt-get install -y git\\n\\ncurl -fsSL get.docker.com | sh -\\n\\ncurl -L https://github.com/docker/compose/releases/download/1.22.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose\\nchmod +x /usr/local/bin/docker-compose\\n\\n# Install Application\\nmkdir -p /opt/comicchat\\n\\ncd /opt/comicchat\\ngit clone ${url} ./\\ngit checkout ${branch}\\n\\nCOMPOSE_OVERRIDE=$(cat <<EOF\\nversion: \\\"2.4\\\"\\nservices:\\n  client:\\n    build:\\n      context: .\\n      args:\\n        WS_URL: \\\"wss://${server_fqdn}:${server_lb_port}\\n\\nEOF\\n)\\n\\necho \\\"$${COMPOSE_OVERRIDE}\\\" > docker-compose.override.yml\\n\\ndocker-compose up -d client\\n\"\r\n"]
[12.347649, "o", "      vars.%:                                    <computed>\r\n\u001b[0m\r\n\u001b[0m\u001b[33m  \u001b[33m~\u001b[0m \u001b[33maws_autoscaling_group.client\r\n"]
[12.347799, "o", "\u001b[0m      launch_configuration:                      \"terraform-demo-client20180831061205010400000001\" => \"${aws_launch_configuration.client.name}\"\r\n"]
[12.347917, "o", "\u001b[0m\r\n\u001b[0m\u001b[33m\u001b[31m-\u001b[0m/\u001b[32m+\u001b[0m \u001b[33maws_launch_configuration.client \u001b[31m\u001b[1m(new resource required)\u001b[0m\r\n"]
[12.34806, "o", "\u001b[0m      id:                                        \"terraform-demo-client20180831061205010400000001\" => <computed> \u001b[31m(forces new resource)\u001b[0m\r\n"]
[12.348152, "o", "      associate_public_ip_address:               \"false\" => \"false\"\r\n"]
[12.348242, "o", "      ebs_block_device.#:                        \"0\" => <computed>\r\n"]
[12.348333, "o", "      ebs_optimized:                             \"false\" => <computed>\r\n      enable_monitoring:                         \"true\" => \"true\"\r\n"]
[12.348435, "o", "      image_id:                                  \"ami-0238c4a6bd553d40a\" => \"ami-0238c4a6bd553d40a\"\r\n"]
[12.348531, "o", "      instance_type:                             \"t2.micro\" => \"t2.micro\"\r\n"]
[12.348626, "o", "      key_name:                                  \"terraform\" => \"terraform\"\r\n"]
[12.348717, "o", "      name:                                      \"terraform-demo-client20180831061205010400000001\" => <computed>\r\n"]
[12.348817, "o", "      name_prefix:                               \"terraform-demo-client\" => \"terraform-demo-client\"\r\n"]
[12.348912, "o", "      root_block_device.#:                       \"1\" => \"1\"\r\n      root_block_device.0.delete_on_termination: \"true\" => \"true\"\r\n"]
[12.349003, "o", "      root_block_device.0.iops:                  \"0\" => <computed>\r\n"]
[12.349159, "o", "      root_block_device.0.volume_size:           \"8\" => \"8\"\r\n"]
[12.349294, "o", "      root_block_device.0.volume_type:           \"gp2\" => \"gp2\"\r\n"]
[12.349411, "o", "      security_groups.#:                         \"1\" => \"1\"\r\n"]
[12.349468, "o", "      security_groups.3879672112:                \"sg-02d6f5605d7bb7e4a\" => \"sg-02d6f5605d7bb7e4a\"\r\n"]
[12.349666, "o", "      user_data:                                 \"ea0699c359c430236bc72c32497a459188b19696\" => \"0aa85067c0f5bbd064a5ceb68eefff39c8964ce7\" \u001b[31m(forces new resource)\u001b[0m\r\n\u001b[0m\r\n"]
[12.349748, "o", "\u001b[0m\u001b[32m  \u001b[32m+\u001b[0m \u001b[32maws_lb_listener.server_wss\r\n"]
[12.349813, "o", "\u001b[0m      id:                                        <computed>\r\n"]
[12.349837, "o", "      arn:                                       <computed>\r\n"]
[12.349972, "o", "      certificate_arn:                           \"arn:aws:acm:ap-southeast-1:957891382910:certificate/992aea66-8188-418a-b38e-88ec2df2526e\"\r\n"]
[12.350043, "o", "      default_action.#:                          \"1\"\r\n"]
[12.350142, "o", "      default_action.0.target_group_arn:         \"arn:aws:elasticloadbalancing:ap-southeast-1:957891382910:targetgroup/terraform-demo-sink/ff00814c63c5660c\"\r\n"]
[12.350198, "o", "      default_action.0.type:                     \"forward\"\r\n"]
[12.350314, "o", "      load_balancer_arn:                         \"arn:aws:elasticloadbalancing:ap-southeast-1:957891382910:loadbalancer/app/terraform-demo/04ae4963ce8b540f\"\r\n"]
[12.350374, "o", "      port:                                      \"8080\"\r\n"]
[12.350433, "o", "      protocol:                                  \"HTTPS\"\r\n"]
[12.350483, "o", "      ssl_policy:                                \"ELBSecurityPolicy-TLS-1-2-2017-01\"\r\n\u001b[0m\r\n"]
[12.350853, "o", "\u001b[0m\u001b[31m  \u001b[31m-\u001b[0m \u001b[31maws_lb_listener_certificate.server\r\n"]
[12.350881, "o", "\u001b[0m\u001b[0m\r\n"]
[12.351022, "o", "\u001b[0m\u001b[33m  \u001b[33m~\u001b[0m \u001b[33maws_lb_listener_rule.client\r\n"]
[12.351166, "o", "\u001b[0m      condition.3104407088.field:                \"host-header\" => \"\"\r\n"]
[12.351318, "o", "      condition.3104407088.values.#:             \"1\" => \"0\"\r\n"]
[12.351504, "o", "      condition.3104407088.values.0:             \"chat.gahmen.tech\" => \"\"\r\n"]
[12.351725, "o", "      condition.~3110813782.field:               \"\" => \"host-header\"\r\n"]
[12.351841, "o", "      condition.~3110813782.values.#:            \"0\" => <computed>\r\n"]
[12.351917, "o", "\u001b[0m\r\n"]
[12.351942, "o", "\u001b[0m\u001b[33m\u001b[31m-\u001b[0m/\u001b[32m+\u001b[0m \u001b[33maws_lb_listener_rule.server \u001b[31m\u001b[1m(new resource required)\u001b[0m\r\n"]
[12.352104, "o", "\u001b[0m      id:                                        \"arn:aws:elasticloadbalancing:ap-southeast-1:957891382910:listener-rule/app/terraform-demo/04ae4963ce8b540f/e1124ab23b65a20a/2d14cc4d97c79fb4\" => <computed> \u001b[31m(forces new resource)\u001b[0m\r\n"]
[12.352175, "o", "      action.#:                                  \"1\" => \"1\"\r\n"]
[12.352322, "o", "      action.0.target_group_arn:                 \"arn:aws:elasticloadbalancing:ap-southeast-1:957891382910:targetgroup/terraform-demo-server/3075d3ca840f4e90\" => \"arn:aws:elasticloadbalancing:ap-southeast-1:957891382910:targetgroup/terraform-demo-server/3075d3ca840f4e90\"\r\n"]
[12.352384, "o", "      action.0.type:                             \"forward\" => \"forward\"\r\n"]
[12.352504, "o", "      arn:                                       \"arn:aws:elasticloadbalancing:ap-southeast-1:957891382910:listener-rule/app/terraform-demo/04ae4963ce8b540f/e1124ab23b65a20a/2d14cc4d97c79fb4\" => <computed>\r\n"]
[12.352561, "o", "      condition.#:                               \"1\" => \"1\"\r\n"]
[12.352612, "o", "      condition.4115963877.field:                \"host-header\" => \"\"\r\n"]
[12.352662, "o", "      condition.4115963877.values.#:             \"1\" => \"0\"\r\n"]
[12.352731, "o", "      condition.4115963877.values.0:             \"chat-server.gahmen.tech\" => \"\"\r\n"]
[12.352787, "o", "      condition.~3110813782.field:               \"\" => \"host-header\"\r\n"]
[12.352848, "o", "      condition.~3110813782.values.#:            \"\" => <computed>\r\n"]
[12.352987, "o", "      listener_arn:                              \"arn:aws:elasticloadbalancing:ap-southeast-1:957891382910:listener/app/terraform-demo/04ae4963ce8b540f/e1124ab23b65a20a\" => \"${aws_lb_listener.server_wss.arn}\" \u001b[31m(forces new resource)\u001b[0m\r\n"]
[12.353043, "o", "      priority:                                  \"101\" => \"100\" \u001b[31m(forces new resource)\u001b[0m\r\n\u001b[0m\r\n"]
[12.3531, "o", "\u001b[0m\u001b[32m  \u001b[32m+\u001b[0m \u001b[32maws_route53_record.domain\r\n"]
[12.353174, "o", "\u001b[0m      id:                                        <computed>\r\n"]
[12.353232, "o", "      alias.#:                                   \"1\"\r\n"]
[12.353286, "o", "      alias.2866050319.evaluate_target_health:   \"false\"\r\n"]
[12.353348, "o", "      alias.2866050319.name:                     \"terraform-demo-1995065107.ap-southeast-1.elb.amazonaws.com\"\r\n"]
[12.353396, "o", "      alias.2866050319.zone_id:                  \"Z1LMS91P8CMLE5\"\r\n"]
[12.353447, "o", "      allow_overwrite:                           \"true\"\r\n"]
[12.353496, "o", "      fqdn:                                      <computed>\r\n"]
[12.353554, "o", "      name:                                      \"chat.gahmen.tech\"\r\n"]
[12.353608, "o", "      type:                                      \"A\"\r\n"]
[12.353669, "o", "      zone_id:                                   \"Z341R9I374MQG8\"\r\n\u001b[0m\r\n"]
[12.353723, "o", "\u001b[0m\u001b[32m  \u001b[32m+\u001b[0m \u001b[32maws_security_group_rule.lb_wss_ingress\r\n"]
[12.353776, "o", "\u001b[0m      id:                                        <computed>\r\n"]
[12.353827, "o", "      cidr_blocks.#:                             \"1\"\r\n"]
[12.353879, "o", "      cidr_blocks.0:                             \"0.0.0.0/0\"\r\n"]
[12.353931, "o", "      from_port:                                 \"8080\"\r\n"]
[12.353983, "o", "      protocol:                                  \"tcp\"\r\n"]
[12.354035, "o", "      security_group_id:                         \"sg-00ea24fe65e8ba90e\"\r\n"]
[12.354085, "o", "      self:                                      \"false\"\r\n"]
[12.354137, "o", "      source_security_group_id:                  <computed>\r\n"]
[12.354187, "o", "      to_port:                                   \"8080\"\r\n"]
[12.354242, "o", "      type:                                      \"ingress\"\r\n\u001b[0m\r\n\u001b[0m\r\n"]
[12.354295, "o", "\u001b[0m\u001b[1mPlan:\u001b[0m 5 to add, 2 to change, 3 to destroy.\u001b[0m\r\n\r\n"]
[12.354349, "o", "\u001b[0m\u001b[1mDo you want to perform these actions?\u001b[0m\r\n"]
[12.354402, "o", "  Terraform will perform the actions described above.\r\n"]
[12.354454, "o", "  Only 'yes' will be accepted to approve.\r\n\r\n"]
[12.454756, "o", "  \u001b[1mEnter a value:\u001b[0m \u001b[0m"]
[14.15933, "o", "y"]
[14.239411, "o", "e"]
[14.394083, "o", "s"]
[14.685446, "o", "\r\n"]
[14.685645, "o", "\r\n"]
[16.651771, "o", "\u001b[0m\u001b[1maws_lb_listener_certificate.server: Destroying... (ID: arn:aws:elasticloadbalancing:ap-southea...e/992aea66-8188-418a-b38e-88ec2df2526e)\u001b[0m\u001b[0m"]
[16.651958, "o", "\r\n\u001b[0m\u001b[1maws_lb_listener_rule.server: Destroying... (ID: arn:aws:elasticloadbalancing:ap-southea...540f/e1124ab23b65a20a/2d14cc4d97c79fb4)\u001b[0m\u001b[0m\r\n"]
[16.659504, "o", "\u001b[0m\u001b[1maws_route53_record.domain: Creating...\u001b[0m\r\n"]
[16.659679, "o", "  alias.#:                                 \"\" => \"1\"\r\n"]
[16.659872, "o", "  alias.2866050319.evaluate_target_health: \"\" => \"false\"\r\n"]
[16.66082, "o", "  alias.2866050319.name:                   \"\" => \"terraform-demo-1995065107.ap-southeast-1.elb.amazonaws.com\"\r\n  alias.2866050319.zone_id:                \"\" => \"Z1LMS91P8CMLE5\"\r\n  allow_overwrite:                         \"\" => \"true\"\r\n"]
[16.661108, "o", "  fqdn:                                    \"\" => \"<computed>\"\r\n"]
[16.662805, "o", "  name:                                    \"\" => \"chat.gahmen.tech\""]
[16.663694, "o", "\r\n  type:                                    \"\" => \"A\"\r\n  zone_id:                                 \"\" => \"Z341R9I374MQG8\"\u001b[0m"]
[16.66439, "o", "\r\n"]
[16.66452, "o", "\u001b[0m\u001b[1maws_security_group_rule.lb_wss_ingress: Creating...\u001b[0m\r\n  cidr_blocks.#:            \"\" => \"1\"\r\n  cidr_blocks.0:            \"\" => \"0.0.0.0/0\"\r\n"]
[16.664695, "o", "  from_port:                \"\" => \"8080\""]
[16.664825, "o", "\r\n"]
[16.667318, "o", "  protocol:                 \"\" => \"tcp\"\r\n  security_group_id:        \"\" => \"sg-00ea24fe65e8ba90e\"\r\n  self:                     \"\" => \"false\"\r\n"]
[16.667577, "o", "  source_security_group_id: \"\" => \"<computed>\"\r\n"]
[16.667678, "o", "  to_port:                  \"\" => \"8080\"\r\n"]
[16.667912, "o", "  type:                     \"\" => \"ingress\"\u001b[0m\r\n"]
[16.66818, "o", "\u001b[0m\u001b[1maws_lb_listener.server_wss: Creating...\u001b[0m\r\n"]
[16.668436, "o", "  arn:                               \"\" => \"<computed>\"\r\n"]
[16.66915, "o", "  certificate_arn:                   \"\" => \"arn:aws:acm:ap-southeast-1:957891382910:certificate/992aea66-8188-418a-b38e-88ec2df2526e\"\r\n"]
[16.66978, "o", "  default_action.#:                  \"\" => \"1\"\r\n"]
[16.670727, "o", "  default_action.0.target_group_arn: \"\" => \"arn:aws:elasticloadbalancing:ap-southeast-1:957891382910:targetgroup/terraform-demo-sink/ff00814c63c5660c\"\r\n"]
[16.672312, "o", "  default_action.0.type:             \"\" => \"forward\"\r\n  load_balancer_arn:                 \"\" => \"arn:aws:elasticloadbalancing:ap-southeast-1:957891382910:loadbalancer/app/terraform-demo/04ae4963ce8b540f\"\r\n  port:                              \"\" => \"8080\"\r\n  protocol:                          \"\" => \"HTTPS\"\r\n  ssl_policy:                        \"\" => \"ELBSecurityPolicy-TLS-1-2-2017-01\"\u001b[0m\r\n"]
[16.731139, "o", "\u001b[0m\u001b[1maws_lb_listener_rule.server: Destruction complete after 0s\u001b[0m\u001b[0m\r\n"]
[16.74158, "o", "\u001b[0m\u001b[1maws_lb_listener_certificate.server: Destruction complete after 0s\u001b[0m\u001b[0m\r\n"]
[16.851071, "o", "\u001b[0m\u001b[1maws_lb_listener.server_wss: Creation complete after 1s (ID: arn:aws:elasticloadbalancing:ap-southea...demo/04ae4963ce8b540f/27fa24624fbf5a01)\u001b[0m\u001b[0m\r\n"]
[16.988326, "o", "\u001b[0m\u001b[1maws_security_group_rule.lb_wss_ingress: Creation complete after 1s (ID: sgrule-3036839263)\u001b[0m\u001b[0m\r\n"]
[26.659471, "o", "\u001b[0m\u001b[1maws_route53_record.domain: Still creating... (10s elapsed)\u001b[0m\u001b[0m\r\n"]
[36.660132, "o", "\u001b[0m\u001b[1maws_route53_record.domain: Still creating... (20s elapsed)\u001b[0m\u001b[0m\r\n"]
[46.660316, "o", "\u001b[0m\u001b[1maws_route53_record.domain: Still creating... (30s elapsed)\u001b[0m\u001b[0m\r\n"]
[56.66091, "o", "\u001b[0m\u001b[1maws_route53_record.domain: Still creating... (40s elapsed)\u001b[0m\u001b[0m\r\n"]
[66.661113, "o", "\u001b[0m\u001b[1maws_route53_record.domain: Still creating... (50s elapsed)\u001b[0m\u001b[0m\r\n"]
[70.547792, "o", "\u001b[0m\u001b[1maws_route53_record.domain: Creation complete after 54s (ID: Z341R9I374MQG8_chat.gahmen.tech_A)\u001b[0m\u001b[0m\r\n"]
[70.564722, "o", "\u001b[0m\u001b[1mdata.template_file.client_user_data: Refreshing state...\u001b[0m\r\n"]
[70.575436, "o", "\u001b[0m\u001b[1maws_lb_listener_rule.server: Creating...\u001b[0m\r\n"]
[70.575952, "o", "  action.#:                      \"\" => \"1\"\r\n"]
[70.576722, "o", "  action.0.target_group_arn:     \"\" => \"arn:aws:elasticloadbalancing:ap-southeast-1:957891382910:targetgroup/terraform-demo-server/3075d3ca840f4e90\"\r\n  action.0.type:                 \"\" => \"forward\"\r\n  arn:                           \"\" => \"<computed>\"\r\n"]
[70.578158, "o", "  condition.#:                   \"\" => \"1\"\r\n  condition.3104407088.field:    \"\" => \"host-header\"\r\n  condition.3104407088.values.#: \"\" => \"1\"\r\n  condition.3104407088.values.0: \"\" => \"chat.gahmen.tech\"\r\n  listener_arn:                  \"\" => \"arn:aws:elasticloadbalancing:ap-southeast-1:957891382910:listener/app/terraform-demo/04ae4963ce8b540f/27fa24624fbf5a01\"\r\n  priority:                      \"\" => \"100\"\u001b[0m\r\n"]
[70.582166, "o", "\u001b[0m\u001b[1maws_launch_configuration.client: Creating...\u001b[0m\r\n"]
[70.585335, "o", "  associate_public_ip_address:               \"\" => \"false\"\r\n  ebs_block_device.#:                        \"\" => \"<computed>\"\r\n  ebs_optimized:                             \"\" => \"<computed>\"\r\n  enable_monitoring:                         \"\" => \"true\"\r\n  image_id:                                  \"\" => \"ami-0238c4a6bd553d40a\"\r\n  instance_type:                             \"\" => \"t2.micro\"\r\n  key_name:                                  \"\" => \"terraform\"\r\n  name:                                      \"\" => \"<computed>\"\r\n  name_prefix:                               \"\" => \"terraform-demo-client\"\r\n  root_block_device.#:                       \"\" => \"1\"\r\n  root_block_device.0.delete_on_termination: \"\" => \"true\"\r\n"]
[70.586407, "o", "  root_block_device.0.iops:                  \"\" => \"<computed>\"\r\n  root_block_device.0.volume_size:           \"\" => \"8\"\r\n  root_block_device.0.volume_type:           \"\" => \"gp2\"\r\n  security_groups.#:                         \"\" => \"1\"\r\n  security_groups.3879672112:                \"\" => \"sg-02d6f5605d7bb7e4a\"\r\n  user_data:                                 \"\" => \"1344a4e053129fd7b7abb0ff78a929733d27cc89\"\u001b[0m\r\n"]
[70.771303, "o", "\u001b[0m\u001b[1maws_lb_listener_rule.server: Creation complete after 0s (ID: arn:aws:elasticloadbalancing:ap-southea...540f/27fa24624fbf5a01/05b94ef720ce840e)\u001b[0m\u001b[0m\r\n"]
[71.635744, "o", "\u001b[0m\u001b[1maws_launch_configuration.client: Creation complete after 1s (ID: terraform-demo-client20180831062310528500000001)\u001b[0m\u001b[0m\r\n"]
[71.653827, "o", "\u001b[0m\u001b[1maws_autoscaling_group.client: Modifying... (ID: terraform-demo-client)\u001b[0m"]
[71.65474, "o", "\r\n"]
[71.655515, "o", "  launch_configuration: \"terraform-demo-client20180831061205010400000001\" => \"terraform-demo-client20180831062310528500000001\"\u001b[0m"]
[71.656552, "o", "\r\n"]
[72.066983, "o", "\u001b[0m\u001b[1maws_autoscaling_group.client: Modifications complete after 1s (ID: terraform-demo-client)\u001b[0m\u001b[0m\r\n"]
[72.080267, "o", "\u001b[0m\u001b[1maws_launch_configuration.client.deposed: Destroying... (ID: terraform-demo-client20180831061205010400000001)\u001b[0m\u001b[0m\r\n"]
[72.53426, "o", "\u001b[0m\u001b[1maws_launch_configuration.client.deposed: Destruction complete after 0s\u001b[0m\u001b[0m\r\n"]
[73.214815, "o", "\u001b[31m\r\n"]
[73.215086, "o", "\u001b[1m\u001b[31mError: \u001b[0m\u001b[0m\u001b[1mError applying plan:\r\n\r\n"]
[73.215231, "o", "1 error(s) occurred:\r\n"]
[73.215357, "o", "\r\n"]
[73.218328, "o", "* aws_lb_listener_rule.client: aws_lb_listener_rule.client: diffs didn't match during apply. This is a bug with Terraform and should be reported as a GitHub Issue.\r\n\r\nPlease include the following information in your report:\r\n\r\n    Terraform Version: 0.11.8\r\n    Resource ID: aws_lb_listener_rule.client\r\n"]
[73.218562, "o", "    Mismatch reason: attribute mismatch: condition.3104407088.values.#"]
[73.219451, "o", "\r\n"]
[73.229014, "o", "    Diff One (usually from plan): *terraform.InstanceDiff{mu:sync.Mutex{state:0, sema:0x0}, Attributes:map[string]*terraform.ResourceAttrDiff{\"condition.3104407088.field\":*terraform.ResourceAttrDiff{Old:\"host-header\", New:\"\", NewComputed:false, NewRemoved:true, NewExtra:interface {}(nil), RequiresNew:false, Sensitive:false, Type:0x0}, \"condition.3104407088.values.0\":*terraform.ResourceAttrDiff{Old:\"chat.gahmen.tech\", New:\"\", NewComputed:false, NewRemoved:true, NewExtra:interface {}(nil), RequiresNew:false, Sensitive:false, Type:0x0}, \"condition.3104407088.values.#\":*terraform.ResourceAttrDiff{Old:\"1\", New:\"0\", NewComputed:false, NewRemoved:false, NewExtra:interface {}(nil), RequiresNew:false, Sensitive:false, Type:0x0}, \"condition.~3110813782.field\":*terraform.ResourceAttrDiff{Old:\"\", New:\"host-header\", NewComputed:false, NewRemoved:false, NewExtra:interface {}(nil), RequiresNew:false, Sensitive:false, Type:0x0}, \"condition.~3110813782.values.#\":*terraform.ResourceAttrDiff{Old:\"0\", New:\"\", NewComputed:true, N"]
[73.229544, "o", "ewRemoved:false, NewExtra:interface {}(nil), RequiresNew:false, Sensitive:false, Type:0x0}}, Destroy:false, DestroyDeposed:false, DestroyTainted:false, Meta:map[string]interface {}(nil)}\r\n"]
[73.230225, "o", "    Diff Two (usually from apply): *terraform.InstanceDiff{mu:sync.Mutex{state:0, sema:0x0}, Attributes:map[string]*terraform.ResourceAttrDiff(nil), Destroy:false, DestroyDeposed:false, DestroyTainted:false, Meta:map[string]interface {}(nil)}\r\n\r\n"]
[73.23085, "o", "Also include as much context as you can about your config, state, and the steps you performed to trigger this error.\r\n"]
[73.231235, "o", "\r\n\r\n"]
[73.231365, "o", "Terraform does not automatically rollback in the face of errors.\r\n"]
[73.231735, "o", "Instead, your Terraform state file has been partially updated with\r\n"]
[73.23197, "o", "any resources that successfully completed. Please address the error\r\n"]
[73.232393, "o", "above and apply again to incrementally change your infrastructure.\u001b[0m\r\n\r\n\u001b[0m\u001b[0m\u001b[0m\r\n"]
[73.279197, "o", "yongwen@yongwen-thinkpad-470s:~/work/open/terraform-talk/demo (\u001b[32mmaster\u001b[0m \u001b[31m*\u001b[0m>)$ "]
[77.223612, "o", "AWS_PROFILE=ace terraform apply --var-file vars.tfvars"]
[77.569445, "o", "\r\n"]
[82.351215, "o", "\u001b[0m\u001b[1mdata.template_file.server_user_data: Refreshing state...\u001b[0m\r\n"]
[84.308025, "o", "\u001b[0m\u001b[1maws_lb_target_group.server: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...terraform-demo-server/3075d3ca840f4e90)\u001b[0m\r\n"]
[84.314506, "o", "\u001b[0m\u001b[1maws_lb_target_group.client: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...terraform-demo-client/f5f7ec5f6941581c)\u001b[0m\r\n"]
[84.318825, "o", "\u001b[0m\u001b[1maws_lb_target_group.sink: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...p/terraform-demo-sink/ff00814c63c5660c)\u001b[0m\r\n"]
[84.320569, "o", "\u001b[0m\u001b[1maws_security_group.server: Refreshing state... (ID: sg-06ca0ba9b5045a065)\u001b[0m"]
[84.321493, "o", "\r\n"]
[84.325774, "o", "\u001b[0m\u001b[1maws_security_group.client: Refreshing state... (ID: sg-02d6f5605d7bb7e4a)\u001b[0m\r\n"]
[84.326893, "o", "\u001b[0m\u001b[1maws_security_group.lb: Refreshing state... (ID: sg-00ea24fe65e8ba90e)\u001b[0m\r\n"]
[84.327398, "o", "\u001b[0m\u001b[1mdata.aws_ami.ubuntu: Refreshing state...\u001b[0m\r\n"]
[84.328241, "o", "\u001b[0m\u001b[1mdata.aws_route53_zone.domain: Refreshing state...\u001b[0m\r\n"]
[84.4091, "o", "\u001b[0m\u001b[1maws_security_group_rule.lb_http_ingress: Refreshing state... (ID: sgrule-941744604)\u001b[0m"]
[84.409421, "o", "\r\n"]
[84.410593, "o", "\u001b[0m\u001b[1maws_security_group_rule.lb_https_ingress: Refreshing state... (ID: sgrule-1554186798)\u001b[0m\r\n"]
[84.410796, "o", "\u001b[0m\u001b[1maws_security_group_rule.lb_wss_ingress: Refreshing state... (ID: sgrule-3036839263)\u001b[0m\r\n"]
[84.412051, "o", "\u001b[0m\u001b[1maws_lb.lb: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...er/app/terraform-demo/04ae4963ce8b540f)\u001b[0m\r\n"]
[84.492934, "o", "\u001b[0m\u001b[1maws_security_group_rule.lb_client_egress: Refreshing state... (ID: sgrule-68608736)\u001b[0m\r\n"]
[84.493954, "o", "\u001b[0m\u001b[1maws_security_group_rule.client_ssh_inbound: Refreshing state... (ID: sgrule-406649271)\u001b[0m\r\n"]
[84.549046, "o", "\u001b[0m\u001b[1maws_security_group_rule.client_egress: Refreshing state... (ID: sgrule-1676281515)\u001b[0m\r\n"]
[84.555662, "o", "\u001b[0m\u001b[1maws_security_group_rule.client_lb_inbound: Refreshing state... (ID: sgrule-2084411941)\u001b[0m\r\n"]
[84.557244, "o", "\u001b[0m\u001b[1maws_security_group_rule.server_ssh_inbound: Refreshing state... (ID: sgrule-3037685237)\u001b[0m\r\n"]
[84.58147, "o", "\u001b[0m\u001b[1maws_security_group_rule.server_egress: Refreshing state... (ID: sgrule-3886950745)\u001b[0m\r\n"]
[84.615873, "o", "\u001b[0m\u001b[1maws_security_group_rule.server_lb_inbound: Refreshing state... (ID: sgrule-2742169836)\u001b[0m\r\n"]
[84.619695, "o", "\u001b[0m\u001b[1maws_security_group_rule.lb_server_egress: Refreshing state... (ID: sgrule-3102978866)\u001b[0m\r\n"]
[84.634452, "o", "\u001b[0m\u001b[1maws_launch_configuration.server: Refreshing state... (ID: terraform-demo-server20180831055342060600000002)\u001b[0m\r\n"]
[84.853784, "o", "\u001b[0m\u001b[1maws_autoscaling_group.server: Refreshing state... (ID: terraform-demo-server)\u001b[0m\r\n"]
[84.970635, "o", "\u001b[0m\u001b[1maws_lb_listener.front_end: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...demo/04ae4963ce8b540f/7fb0c481594d516a)\u001b[0m\r\n"]
[84.971148, "o", "\u001b[0m\u001b[1maws_lb_listener.server_wss: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...demo/04ae4963ce8b540f/27fa24624fbf5a01)\u001b[0m"]
[84.972342, "o", "\r\n\u001b[0m\u001b[1maws_lb_listener.https: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...demo/04ae4963ce8b540f/e1124ab23b65a20a)\u001b[0m\r\n"]
[85.183606, "o", "\u001b[0m\u001b[1maws_autoscaling_attachment.server: Refreshing state... (ID: terraform-demo-server-20180831053405780000000004)\u001b[0m\r\n"]
[86.549826, "o", "\u001b[0m\u001b[1maws_route53_record.domain: Refreshing state... (ID: Z341R9I374MQG8_chat.gahmen.tech_A)\u001b[0m\r\n"]
[89.93963, "o", "\u001b[0m\u001b[1maws_lb_listener_rule.server: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...540f/27fa24624fbf5a01/05b94ef720ce840e)\u001b[0m\r\n"]
[89.94207, "o", "\u001b[0m\u001b[1maws_lb_listener_rule.client: Refreshing state... (ID: arn:aws:elasticloadbalancing:ap-southea...540f/e1124ab23b65a20a/148e0cba47802291)\u001b[0m\r\n"]
[89.944807, "o", "\u001b[0m\u001b[1mdata.template_file.client_user_data: Refreshing state...\u001b[0m\r\n"]
[89.949668, "o", "\u001b[0m\u001b[1maws_launch_configuration.client: Refreshing state... (ID: terraform-demo-client20180831062310528500000001)\u001b[0m\r\n"]
[90.27936, "o", "\u001b[0m\u001b[1maws_autoscaling_group.client: Refreshing state... (ID: terraform-demo-client)\u001b[0m\r\n"]
[90.474733, "o", "\u001b[0m\u001b[1maws_autoscaling_attachment.client: Refreshing state... (ID: terraform-demo-client-20180831053725363100000006)\u001b[0m\r\n"]
[92.991222, "o", "\u001b[0m\u001b[1m\u001b[32m\r\n"]
[92.991396, "o", "Apply complete! Resources: 0 added, 0 changed, 0 destroyed.\u001b[0m\r\n"]
[93.188259, "o", "yongwen@yongwen-thinkpad-470s:~/work/open/terraform-talk/demo (\u001b[32mmaster\u001b[0m \u001b[31m*\u001b[0m>)$ "]
[95.175921, "o", "exit\r\n"]
